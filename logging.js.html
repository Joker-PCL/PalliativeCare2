<script>
  // logging.js

  const Logging = {
    logUserAction: function (action, details) {
      const timestamp = new Date().toISOString();
      const user = Session.getActiveUser().getEmail();

      const logSheet = SpreadsheetApp.openById(SHEET_ID).getSheetByName('UserLogs');
      logSheet.appendRow([timestamp, user, action, JSON.stringify(details)]);
    },

    getUserLogs: function (email, startDate, endDate) {
      const logSheet = SpreadsheetApp.openById(SHEET_ID).getSheetByName('UserLogs');
      const logs = logSheet.getDataRange().getValues();

      return logs.filter((log) => {
        const logDate = new Date(log[0]);
        return log[1] === email && (!startDate || logDate >= new Date(startDate)) && (!endDate || logDate <= new Date(endDate));
      });
    },
  };
</script>
